document.addEventListener("DOMContentLoaded", function () {
    const currentUrl = window.location.pathname.split('/').pop();
    const backButtonSections = document.getElementsByClassName('back-button-section');
    const previousLessonBtn = document.getElementById('previous-lesson-btn');
    const headerInner = document.querySelector('.header__inner');
    const homeLink = document.getElementById('homeLink');

    function updateHeaderStyle() {
        if (headerInner) {
            if (window.innerWidth <= 375 && backButtonSections.length === 0) {
                headerInner.style.justifyContent = 'center';
            } else {
                headerInner.style.justifyContent = ''; // Сброс стилей
            }
        }
    }

    updateHeaderStyle();
    window.addEventListener('resize', updateHeaderStyle);

    if (backButtonSections.length > 0) {
        const backButtonSection = backButtonSections[0];
        if (currentUrl === 'category_1.html') {
            backButtonSection.style.position = 'absolute';
            backButtonSection.style.left = '0';
        } else {
            backButtonSection.style.position = '';
            backButtonSection.style.left = '';
        }

        const backButton = backButtonSection.querySelector('.btn--back-button');
        if (backButton) {
            backButton.addEventListener('click', function () {
                window.location.href = 'index.html';
            });
        }
    }

    const lessons = [
        'hmfs_1.html',
        'hmfs_2.html',
        'hmfs_3.html',
        'hmfs_4.html',
        'hmfs_5.html',
        'hmfs_6.html'
    ];

    const currentIndex = lessons.indexOf(currentUrl);

    const nextLessonBtn = document.getElementById('next-lesson-btn');
    if (nextLessonBtn) {
        if (currentIndex !== -1) {
            if (currentIndex < lessons.length - 1) {
                const nextLessonUrl = lessons[currentIndex + 1];
                nextLessonBtn.href = nextLessonUrl;
                nextLessonBtn.style.display = 'inline-block';
            } else {
                nextLessonBtn.style.display = 'none';
            }
        } else {
            nextLessonBtn.style.display = 'none';
        }
    }

    if (previousLessonBtn) {
        if (currentIndex > 0) {
            const previousLessonUrl = lessons[currentIndex - 1];
            previousLessonBtn.href = previousLessonUrl;
            previousLessonBtn.style.display = 'inline-block';
        } else {
            previousLessonBtn.style.display = 'none';
        }
    }
    if (homeLink) {
        function handleHomeLinkClick() {
            if (window.innerWidth >= 767) {
                window.location.href = 'index.html';
            }
        }

        if (window.innerWidth >= 767) {
            homeLink.addEventListener('click', handleHomeLinkClick);
        }

        window.addEventListener('resize', function () {
            if (window.innerWidth < 767) {
                homeLink.removeEventListener('click', handleHomeLinkClick);
            } else {
                homeLink.addEventListener('click', handleHomeLinkClick);
            }
        });
    }
    const questions = document.querySelectorAll('.quiz-question');
    const submitButton = document.getElementById('submit-quiz');

    function checkIfAllQuestionsAnswered() {
        let allAnswered = true;
        questions.forEach(question => {
            const isAnswered = question.querySelector('input[type=radio]:checked');
            if (!isAnswered) {
                allAnswered = false;
            }
        });
        submitButton.classList.toggle('show', allAnswered);
    }

    document.querySelectorAll('.quiz-question input[type=radio]').forEach(radio => {
        radio.addEventListener('change', checkIfAllQuestionsAnswered);
    });

    submitButton.addEventListener('click', function () {
        const correctAnswers = {
            q1: 'B',
            q2: 'B',
            q3: 'B',
            q4: 'C',
            q5: 'A'
        };
        let score = 0;
        let totalQuestions = Object.keys(correctAnswers).length;
        for (let question in correctAnswers) {
            const selectedOption = document.querySelector(`input[name=${question}]:checked`);
            if (selectedOption && selectedOption.value === correctAnswers[question]) {
                score++;
            }
        }
        const resultText = `You answered ${score} out of ${totalQuestions} questions correctly.`;
        document.getElementById('quiz-result').innerText = resultText;
    });
});
